!function(C,D){"undefined"!=typeof module&&module.exports?(D("undefined"==typeof angular?require("angular"):angular),module.exports="ngDialog"):"function"==typeof define&&define.amd?define(["angular"],D):D(C.angular)}(this,function(O){var Q=O.module("ngDialog",[]),b=O.element,R=O.isDefined,W=(document.body||document.documentElement).style,S=R(W.animation)||R(W.WebkitAnimation)||R(W.MozAnimation)||R(W.MsAnimation)||R(W.OAnimation),T="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",Z="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]",a="ngdialog-disabled-animation",U={html:!1,body:!1},V={},Y=[],P=!1,X=!1;return Q.provider("ngDialog",function(){var C=this.defaults={className:"ngdialog-theme-default",appendClassName:"",disableAnimation:!1,plain:!1,showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,overlay:!0,cache:!0,trapFocus:!0,preserveFocus:!0,ariaAuto:!0,ariaRole:null,ariaLabelledById:null,ariaLabelledBySelector:null,ariaDescribedById:null,ariaDescribedBySelector:null,bodyClassName:"ngdialog-open",width:null};this.setForceHtmlReload=function(F){U.html=F||!1},this.setForceBodyReload=function(F){U.body=F||!1},this.setDefaults=function(F){O.extend(C,F)},this.setOpenOnePerName=function(F){X=F||!1};var D,B=0,E=0,A={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$injector",function(N,h,i,K,I,g,J,F,G,j){var M=[],L={onDocumentKeydown:function(c){27===c.keyCode&&H.close("$escape")},activate:function(c){var d=c.data("$ngDialogOptions");d.trapFocus&&(c.on("keydown",L.onTrapFocusKeydown),M.body.on("keydown",L.onTrapFocusKeydown))},deactivate:function(c){c.off("keydown",L.onTrapFocusKeydown),M.body.off("keydown",L.onTrapFocusKeydown)},deactivateAll:function(c){O.forEach(c,function(d){var e=O.element(d);L.deactivate(e)})},setBodyPadding:function(c){var d=parseInt(M.body.css("padding-right")||0,10);M.body.css("padding-right",d+c+"px"),M.body.data("ng-dialog-original-padding",d),g.$broadcast("ngDialog.setPadding",c)},resetBodyPadding:function(){var c=M.body.data("ng-dialog-original-padding");c?M.body.css("padding-right",c+"px"):M.body.css("padding-right",""),g.$broadcast("ngDialog.setPadding",0)},performCloseDialog:function(e,q){var d=e.data("$ngDialogOptions"),f=e.attr("id"),c=V[f];if(c){if("undefined"!=typeof F.Hammer){var s=c.hammerTime;s.off("tap",D),s.destroy&&s.destroy(),delete c.hammerTime}else{e.unbind("click")}1===E&&M.body.unbind("keydown",L.onDocumentKeydown),e.hasClass("ngdialog-closing")||(E-=1);var r=e.data("$ngDialogPreviousFocus");r&&r.focus&&r.focus(),g.$broadcast("ngDialog.closing",e,q),E=0>E?0:E,S&&!d.disableAnimation?(c.$destroy(),e.unbind(T).bind(T,function(){L.closeDialogElement(e,q)}).addClass("ngdialog-closing")):(c.$destroy(),L.closeDialogElement(e,q)),A[f]&&(A[f].resolve({id:f,value:q,$dialog:e,remainingDialogs:E}),delete A[f]),V[f]&&delete V[f],Y.splice(Y.indexOf(f),1),Y.length||(M.body.unbind("keydown",L.onDocumentKeydown),P=!1)}},closeDialogElement:function(d,c){var e=d.data("$ngDialogOptions");d.remove(),0===E&&(M.html.removeClass(e.bodyClassName),M.body.removeClass(e.bodyClassName),L.resetBodyPadding()),g.$broadcast("ngDialog.closed",d,c)},closeDialog:function(d,f){var c=d.data("$ngDialogPreCloseCallback");if(c&&O.isFunction(c)){var e=c.call(d,f);O.isObject(e)?e.closePromise?e.closePromise.then(function(){L.performCloseDialog(d,f)}):e.then(function(){L.performCloseDialog(d,f)},function(){}):e!==!1&&L.performCloseDialog(d,f)}else{L.performCloseDialog(d,f)}},onTrapFocusKeydown:function(d){var f,c=O.element(d.currentTarget);if(c.hasClass("ngdialog")){f=c}else{if(f=L.getActiveDialog(),null===f){return}}var e=9===d.keyCode,l=d.shiftKey===!0;e&&L.handleTab(f,d,l)},handleTab:function(f,x,e){var u=L.getFocusableElements(f);if(0===u.length){return void (document.activeElement&&document.activeElement.blur())}var v=document.activeElement,c=Array.prototype.indexOf.call(u,v),d=-1===c,z=0===c,w=c===u.length-1,y=!1;e?(d||z)&&(u[u.length-1].focus(),y=!0):(d||w)&&(u[0].focus(),y=!0),y&&(x.preventDefault(),x.stopPropagation())},autoFocus:function(e){var o=e[0],d=o.querySelector("*[autofocus]");if(null===d||(d.focus(),document.activeElement!==d)){var n=L.getFocusableElements(e);if(n.length>0){return void n[0].focus()}var f=L.filterVisibleElements(o.querySelectorAll("h1,h2,h3,h4,h5,h6,p,span"));if(f.length>0){var c=f[0];b(c).attr("tabindex","-1").css("outline","0"),c.focus()}}},getFocusableElements:function(f){var c=f[0],d=c.querySelectorAll(Z),e=L.filterTabbableElements(d);return L.filterVisibleElements(e)},filterTabbableElements:function(f){for(var d=[],c=0;c<f.length;c++){var e=f[c];"-1"!==b(e).attr("tabindex")&&d.push(e)}return d},filterVisibleElements:function(f){for(var c=[],d=0;d<f.length;d++){var e=f[d];(e.offsetWidth>0||e.offsetHeight>0)&&c.push(e)}return c},getActiveDialog:function(){var c=document.querySelectorAll(".ngdialog");return 0===c.length?null:b(c[c.length-1])},applyAriaAttributes:function(d,c){if(c.ariaAuto){if(!c.ariaRole){var e=L.getFocusableElements(d).length>0?"dialog":"alertdialog";c.ariaRole=e}c.ariaLabelledBySelector||(c.ariaLabelledBySelector="h1,h2,h3,h4,h5,h6"),c.ariaDescribedBySelector||(c.ariaDescribedBySelector="article,section,p")}c.ariaRole&&d.attr("role",c.ariaRole),L.applyAriaAttribute(d,"aria-labelledby",c.ariaLabelledById,c.ariaLabelledBySelector),L.applyAriaAttribute(d,"aria-describedby",c.ariaDescribedById,c.ariaDescribedBySelector)},applyAriaAttribute:function(d,p,q,r){if(q&&d.attr(p,q),r){var e=d.attr("id"),c=d[0].querySelector(r);if(!c){return}var f=e+"-"+p;return b(c).attr("id",f),d.attr(p,f),f}},detectUIRouter:function(){try{return O.module("ui.router"),!0}catch(c){return !1}},getRouterLocationEventName:function(){return L.detectUIRouter()?"$stateChangeSuccess":"$locationChangeSuccess"}},H={__PRIVATE__:L,open:function(f){function q(k,l){return g.$broadcast("ngDialog.templateLoading",k),I.get(k,l||{}).then(function(m){return g.$broadcast("ngDialog.templateLoaded",k),m.data||""})}function x(k){return k?O.isString(k)&&z.plain?k:"boolean"!=typeof z.cache||z.cache?q(k,{cache:h}):q(k,{cache:!1}):"Empty template"}var Aa=null;if(f=f||{},!(X&&f.name&&(Aa=f.name+" dialog",this.isOpen(Aa)))){var z=O.copy(C),c=++B;Aa=Aa||"ngdialog"+c,Y.push(Aa),"undefined"!=typeof z.data&&("undefined"==typeof f.data&&(f.data={}),f.data=O.merge(O.copy(z.data),f.data)),O.extend(z,f);var d;A[Aa]=d=K.defer();var y;V[Aa]=y=O.isObject(z.scope)?z.scope.$new():g.$new();var e,w,v=O.extend({},z.resolve);return O.forEach(v,function(k,l){v[l]=O.isString(k)?j.get(k):j.invoke(k,null,null,l)}),K.all({template:x(z.template||z.templateUrl),locals:K.all(v)}).then(function(Ac){var o=Ac.template,n=Ac.locals;z.showClose&&(o+='<div class="ngdialog-close"></div>');var r=z.overlay?"":" ngdialog-no-overlay";if(e=b('<div id="'+Aa+'" class="ngdialog'+r+'"></div>'),e.html(z.overlay?'<div class="ngdialog-overlay"></div><div class="ngdialog-content" role="document">'+o+"</div>":'<div class="ngdialog-content" role="document">'+o+"</div>"),e.data("$ngDialogOptions",z),y.ngDialogId=Aa,z.data&&O.isString(z.data)){var u=z.data.replace(/^\s*/,"")[0];y.ngDialogData="{"===u||"["===u?O.fromJson(z.data):new String(z.data),y.ngDialogData.ngDialogId=Aa}else{z.data&&O.isObject(z.data)&&(y.ngDialogData=z.data,y.ngDialogData.ngDialogId=Aa)}if(z.className&&e.addClass(z.className),z.appendClassName&&e.addClass(z.appendClassName),z.width){var t=e[0].querySelector(".ngdialog-content");O.isString(z.width)?t.style.width=z.width:t.style.width=z.width+"px"}if(z.disableAnimation&&e.addClass(a),w=z.appendTo&&O.isString(z.appendTo)?O.element(document.querySelector(z.appendTo)):M.body,L.applyAriaAttributes(e,z),z.preCloseCallback){var p;O.isFunction(z.preCloseCallback)?p=z.preCloseCallback:O.isString(z.preCloseCallback)&&y&&(O.isFunction(y[z.preCloseCallback])?p=y[z.preCloseCallback]:y.$parent&&O.isFunction(y.$parent[z.preCloseCallback])?p=y.$parent[z.preCloseCallback]:g&&O.isFunction(g[z.preCloseCallback])&&(p=g[z.preCloseCallback])),p&&e.data("$ngDialogPreCloseCallback",p)}if(y.closeThisDialog=function(Ab){L.closeDialog(e,Ab)},z.controller&&(O.isString(z.controller)||O.isArray(z.controller)||O.isFunction(z.controller))){var s;z.controllerAs&&O.isString(z.controllerAs)&&(s=z.controllerAs);var k=G(z.controller,O.extend(n,{$scope:y,$element:e}),!0,s);z.bindToController&&O.extend(k.instance,{ngDialogId:y.ngDialogId,ngDialogData:y.ngDialogData,closeThisDialog:y.closeThisDialog}),e.data("$ngDialogControllerController",k())}if(J(function(){var Af=document.querySelectorAll(".ngdialog");L.deactivateAll(Af),i(e)(y);var Ab=F.innerWidth-M.body.prop("clientWidth");M.html.addClass(z.bodyClassName),M.body.addClass(z.bodyClassName);var Ad=Ab-(F.innerWidth-M.body.prop("clientWidth"));Ad>0&&L.setBodyPadding(Ad),w.append(e),L.activate(e),z.trapFocus&&L.autoFocus(e),z.name?g.$broadcast("ngDialog.opened",{dialog:e,name:z.name}):g.$broadcast("ngDialog.opened",e)}),P||(M.body.bind("keydown",L.onDocumentKeydown),P=!0),z.closeByNavigation){var l=L.getRouterLocationEventName();g.$on(l,function(){L.closeDialog(e)})}if(z.preserveFocus&&e.data("$ngDialogPreviousFocus",document.activeElement),D=function(Af){var Ab=z.closeByDocument?b(Af.target).hasClass("ngdialog-overlay"):!1,Ad=b(Af.target).hasClass("ngdialog-close");(Ab||Ad)&&H.close(e.attr("id"),Ad?"$closeButton":"$document")},"undefined"!=typeof F.Hammer){var m=y.hammerTime=F.Hammer(e[0]);m.on("tap",D)}else{e.bind("click",D)}return E+=1,H}),{id:Aa,closePromise:d.promise,close:function(k){L.closeDialog(e,k)}}}},openConfirm:function(d){var e=K.defer(),f=O.copy(C);d=d||{},"undefined"!=typeof f.data&&("undefined"==typeof d.data&&(d.data={}),d.data=O.merge(O.copy(f.data),d.data)),O.extend(f,d),f.scope=O.isObject(f.scope)?f.scope.$new():g.$new(),f.scope.confirm=function(m){e.resolve(m);var k=b(document.getElementById(c.id));L.performCloseDialog(k,m)};var c=H.open(f);return c?(c.closePromise.then(function(k){return k?e.reject(k.value):e.reject()}),e.promise):void 0},isOpen:function(c){var d=b(document.getElementById(c));return d.length>0},close:function(f,d){var c=b(document.getElementById(f));if(c.length){L.closeDialog(c,d)}else{if("$escape"===f){var e=Y[Y.length-1];c=b(document.getElementById(e)),c.data("$ngDialogOptions").closeByEscape&&L.closeDialog(c,"$escape")}else{H.closeAll(d)}}return H},closeAll:function(f){for(var d=document.querySelectorAll(".ngdialog"),c=d.length-1;c>=0;c--){var e=d[c];L.closeDialog(b(e),f)}},getOpenDialogs:function(){return Y},getDefaults:function(){return C}};return O.forEach(["html","body"],function(c){if(M[c]=N.find(c),U[c]){var d=L.getRouterLocationEventName();g.$on(d,function(){M[c]=N.find(c)})}}),H}]}),Q.directive("ngDialog",["ngDialog",function(A){return{restrict:"A",scope:{ngDialogScope:"="},link:function(B,C,D){C.on("click",function(F){F.preventDefault();var G=O.isDefined(B.ngDialogScope)?B.ngDialogScope:"noScope";O.isDefined(D.ngDialogClosePrevious)&&A.close(D.ngDialogClosePrevious);var E=A.getDefaults();A.open({template:D.ngDialog,className:D.ngDialogClass||E.className,appendClassName:D.ngDialogAppendClass,controller:D.ngDialogController,controllerAs:D.ngDialogControllerAs,bindToController:D.ngDialogBindToController,scope:G,data:D.ngDialogData,showClose:"false"===D.ngDialogShowClose?!1:"true"===D.ngDialogShowClose?!0:E.showClose,closeByDocument:"false"===D.ngDialogCloseByDocument?!1:"true"===D.ngDialogCloseByDocument?!0:E.closeByDocument,closeByEscape:"false"===D.ngDialogCloseByEscape?!1:"true"===D.ngDialogCloseByEscape?!0:E.closeByEscape,overlay:"false"===D.ngDialogOverlay?!1:"true"===D.ngDialogOverlay?!0:E.overlay,preCloseCallback:D.ngDialogPreCloseCallback||E.preCloseCallback,bodyClassName:D.ngDialogBodyClass||E.bodyClassName})})}}}]),Q});